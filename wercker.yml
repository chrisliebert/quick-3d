# Copyright (C) 2016 Chris Liebert

# This references a standard debian container from the
# Docker Hub https://registry.hub.docker.com/_/debian/
# Read more about containers on our dev center
# http://devcenter.wercker.com/docs/containers/index.html
box: debian

build:
  steps:
    - install-packages:
        packages: curl file build-essential cmake swig liblua5.1-dev lua5.1 openjdk-7-jdk python-all-dev mono-mcs
    - script:
        name: install-rust
        code: |
            curl https://static.rust-lang.org/rustup.sh --output rustup.sh
            sh rustup.sh --disable-sudo
    - script:
        name: build-quick3d
        code: |
            cargo build
            cd ffi/C
            cargo build
            cd ../CSharp
            cargo build
            cd ../Java
            cargo build
            cd ../Python
            cargo build
    - script:
        name: test-quick3d
        code: |
            cargo test --verbose
            cd ffi/C
            cargo test --verbose
            cd ../CSharp
            cargo test --verbose
            cd ../Java
            cargo test --verbose
            cd ../Lua
            cargo test --verbose
            cd ../Python
            cargo test --verbose
